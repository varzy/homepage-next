---
title: "åœ¨å¾®ä¿¡å°ç¨‹åºé¡¹ç›®ä¸­å¼•å…¥ ESLint å’Œ Prettier"
category: "Coding"
type: "Post"
status: "Published"
tags: ["Miniprogram", "ESLint", "Prettier"]
date: "2021-03-18"
slug: "miniprogram-use-eslint-and-prettier"
summary: ""
last_edited_time: "2024-03-16T08:21:00.000Z"
notion_id: "d8b8d8e8-1895-4173-9008-058ed75b6cd5"
---


åœ¨ä¹‹å‰çš„é¡¹ç›®ä¸­ï¼Œæˆ‘å¼•å…¥äº† Prettier ç”¨äºæ ¼å¼åŒ–å¾®ä¿¡å°ç¨‹åºçš„é¡¹ç›®ä»£ç ï¼Œå…·ä½“å¯ä»¥æŸ¥çœ‹ï¼š[ä½¿ç”¨ Prettier æ ¼å¼åŒ–å¾®ä¿¡å°ç¨‹åºä»£ç ](https://www.notion.so/5c8154428abb45008492a6f8d4febe25) ã€‚


ä½†éšç€é¡¹ç›®è¶Šæ¥è¶Šå¤§ï¼Œé äººè„‘å»æ£€æŸ¥ä»£ç å˜å¾—è¶Šæ¥è¶Šå¤æ‚ï¼Œæˆ‘å¼€å§‹æ€€å¿µä½¿ç”¨ Vue Cli ç¼–å†™ä»£ç æ—¶ ESLint æä¾›çš„å¼ºå¤§ä»£ç æ£€æŸ¥èƒ½åŠ›ã€‚äºæ˜¯åœ¨ä¸Šä¸€ç¯‡å¼•å…¥ Prettier çš„åŸºç¡€ä¸Šï¼Œæˆ‘åˆå°è¯•å¼•å…¥äº† ESLintã€‚ç›®å‰æ¥çœ‹å‘å…¶å®å¹¶ä¸å¤šï¼Œæœ€ç»ˆçš„æ•ˆæœä¹Ÿæ¯”è¾ƒä»¤äººæ»¡æ„ã€‚


## ç›®æ ‡ & ç»“æœ

- âœ… æ‰§è¡Œä¸€æ¡ npm è„šæœ¬ï¼Œè‡ªåŠ¨ä½¿ç”¨ Prettier æ ¼å¼åŒ–ä»£ç ï¼Œå¹¶ç”¨ ESLint æ£€æŸ¥ js è¯­æ³•ã€‚æ£€æŸ¥ç»“æœèƒ½å¤Ÿåœ¨ç»ˆç«¯ä¸­è¾“å‡º

	![OaPjbwAl4DckuG2.png](https://cdn.sa.net/2024/03/15/OaPjbwAl4DckuG2.png)

- âœ… åœ¨ VSCode ä¸­è‡ªåŠ¨æ˜¾ç¤º ESLint æ£€æŸ¥ç»“æœã€‚å‰ææ˜¯éœ€è¦å®‰è£… ESLint æ’ä»¶

	![MRnxPNg3sB1if8V.png](https://cdn.sa.net/2024/03/15/MRnxPNg3sB1if8V.png)

- ~~âŒ åœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­è‡ªåŠ¨æ˜¾ç¤º ESLint æ£€æŸ¥ç»“æœã€‚~~~~_å¤±è´¥åŸå› ï¼šå¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­è™½ç„¶æ”¯æŒæ·»åŠ è‡ªå®šä¹‰çš„ VSCode æ’ä»¶ï¼Œä½†æŠŠ ESLint æ’ä»¶å¤åˆ¶åˆ°å¾®ä¿¡å¼€å‘è€…å·¥å…·çš„è‡ªå®šä¹‰æ’ä»¶ç›®å½•åå¹¶ä¸èƒ½ç”Ÿæ•ˆ_~~
- (æ›´æ–°äº2021.07.01) âœ… åœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­è‡ªåŠ¨æ˜¾ç¤º ESLint æ£€æŸ¥ç»“æœã€‚å¾®ä¿¡å¼€å‘è€…å·¥å…·è‡ª `Stable 1.05.2106250` ç‰ˆæœ¬å¼€å§‹æ”¯æŒå®‰è£…éƒ¨åˆ† VSCode æ’ä»¶ï¼Œå› æ­¤åœ¨å¼€å‘è€…å·¥å…·ä¸­å®‰è£… ESLint æ’ä»¶åå³å¯æ­£å¸¸å¼€å¯æ£€æŸ¥

	![9Acfz1Q4RxqCheN.png](https://cdn.sa.net/2024/03/15/9Acfz1Q4RxqCheN.png)


## åŸç†

- ä¸å†ä½¿ç”¨ Prettier ç›´æ¥æ ¼å¼åŒ– js æ–‡ä»¶ï¼Œè€Œæ˜¯é€šè¿‡ ESLint + Prettier æ’ä»¶å®ç°å¯¹ js æ–‡ä»¶çš„è‡ªåŠ¨æ ¼å¼åŒ–ã€‚å½“ç„¶ï¼ŒPrettier è¿˜è¦è´Ÿè´£ç»§ç»­æ ¼å¼åŒ– js ä»¥å¤–çš„æ–‡ä»¶
- ä½¿ç”¨ ESLint æ£€æŸ¥ js æ–‡ä»¶ï¼Œå¹¶ä¸”ç”±äºå°ç¨‹åºæ”¯æŒé«˜çº§è¯­æ³•çš„è‡ªåŠ¨ç¼–è¯‘ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ç»“åˆ Babel å»è§£æé«˜çº§çš„ js è¯­æ³•

## å®ç°


### å¼•å…¥ Prettier


å…·ä½“å¯ä»¥æŸ¥çœ‹å‰æ–‡ [ä½¿ç”¨ Prettier æ ¼å¼åŒ–å¾®ä¿¡å°ç¨‹åºä»£ç ](https://www.notion.so/5c8154428abb45008492a6f8d4febe25) ï¼Œæ­¤å¤„ä¸å†èµ˜è¿°ã€‚å½“ç„¶ï¼Œå¦‚æœä½ ä¸æƒ³ä½¿ç”¨ Prettierï¼Œå®Œå…¨å¯ä»¥åªä¿®æ”¹ç›®å½•ç»“æ„ï¼Œä¿è¯å’Œä¸‹é¢çš„æ­¥éª¤å…¼å®¹å³å¯ã€‚


### å¼•å…¥ ESLint


é¦–å…ˆï¼Œæˆ‘ä»¬å®‰è£… ESLint ç›¸å…³ä¾èµ–ï¼š


```bash
yarn add -D eslint eslint-config-prettier eslint-plugin-prettier
```


ç›¸å…³æ–‡æ¡£ï¼š

- [Configuring ESLint](https://eslint.org/docs/user-guide/configuring/)
- [eslint-plugin-prettier](https://github.com/prettier/eslint-plugin-prettier)

æ¥ç€ï¼Œåœ¨æ ¹ç›®å½•ä¸‹æ·»åŠ  `.eslintrc.js`ï¼š


```javascript
module.exports = {
  env: {
    browser: true,
    node: true,
    es6: true,
    commonjs: true
  },
  extends: ['eslint:recommended', "plugin:prettier/recommended"],
  parser: '@babel/eslint-parser',
  parserOptions: {
    ecmaVersion: 6,
    sourceType: 'module'
  },
  globals: {
    App: true,
    Page: true,
    Component: true,
    Behavior: true,
    wx: true,
    getApp: true,
    getCurrentPages: true
  },
  rules: {
		// æœªä½¿ç”¨çš„å˜é‡ä¹Ÿä¸ä¼šå¯¹å°ç¨‹åºæœ‰å¾ˆå¤§å½±å“ï¼Œå› æ­¤è®¾ä¸º warn
    'no-unused-vars': 'warn',
		// prettier çš„å¼‚å¸¸å¤§å¤šæ˜¯ä»£ç æ ¼å¼é—®é¢˜ï¼Œè®¾ä¸º warn å°±å¯ä»¥äº†
    'prettier/prettier': 'warn'
  }
};
```


æ³¨æ„ï¼šä¸Šé¢çš„ ESLint é…ç½®ä¸­æœ‰è¿™ä¹ˆä¸€æ¡ï¼š`parser: '@babel/eslint-parser'`ã€‚parser å°±æ˜¯ ESLint çš„è§£æå™¨ï¼Œç”±äºå°ç¨‹åºé‡Œä½¿ç”¨äº† ES6+ çš„è¯­æ³•ï¼Œå› æ­¤æˆ‘ä»¬è¿˜éœ€è¦å¼•å…¥ Babelã€‚


### å¼•å…¥ Babel


é¦–å…ˆå®‰è£… Babel å’Œ ESLint ä½¿ç”¨çš„è§£æå™¨ï¼š


```bash
yarn add -D @babel/core @babel/eslint-parser
```


> âš ï¸ æ³¨æ„ï¼šæˆ‘ä»¬è¿™é‡Œå®‰è£…çš„æ˜¯ [@babel/eslint-parser](https://github.com/babel/babel/tree/main/eslint/babel-eslint-parser) è€Œéç½‘ä¸Šå¾ˆå¤šè€æ•™ç¨‹é‡Œçš„ [babel-eslint](https://github.com/babel/babel-eslint)ã€‚å¦‚æœä½ ç‚¹è¿› babel-eslint çš„ä»“åº“å°±ä¼šå‘ç°è¿™ä¸ªä¾èµ–å·²ç»è¢«å½’æ¡£äº†ï¼Œç°åœ¨æ›´æ¨èä½¿ç”¨å‰è€…ã€‚


æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ·»åŠ  babel çš„é…ç½®ã€‚ç”±äºæˆ‘ä»¬ä»…éœ€è¦æ»¡è¶³æœ€åŸºæœ¬çš„è§£æéœ€æ±‚ï¼Œæ‰€ä»¥é…ç½®æ–‡ä»¶åº”è¯¥æ€ä¹ˆç®€å•æ€ä¹ˆæ¥ï¼Œå› æ­¤æˆ‘ä»¬ç›´æ¥é€‰ç”¨ `@babel/pretset-env`ã€‚å®‰è£…ï¼š


```javascript
yarn add -D @babel/preset-env
```


æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åœ¨æ ¹ç›®å½•æ·»åŠ é…ç½®æ–‡ä»¶ `babel.config.js`ï¼Œå…·ä½“å¯ä»¥æŸ¥çœ‹[æ–‡æ¡£](https://babeljs.io/docs/en/configuration)ã€‚åœ¨  `babel.config.js` ä¸­å†™å…¥ï¼š


```javascript
module.exports = {
  presets: ['@babel/preset-env']
};
```


All Doneï¼ç†è®ºä¸Šç°åœ¨æ‰€æœ‰çš„é…ç½®éƒ½å·²ç»å®Œæˆäº†ï¼ä¸è¿‡ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æŠŠ Babel çš„ targets è®¾ç½®ä¸ºå¾®ä¿¡å¼€å‘è€…å·¥å…·ç¼–è¯‘æ—¶çš„ç›¸åŒé…ç½®ï¼Œè¿™æ ·å°±å¯ä»¥ä¿è¯ Babel è§£æå™¨è¿›ä¸€æ­¥è´´è¿‘ç”Ÿäº§ç¯å¢ƒã€‚


```javascript
module.exports = {
  // <https://developers.weixin.qq.com/miniprogram/dev/devtools/codecompile.html>
  targets: {
    chrome: '53',
    ios: '8'
  },
  presets: ['@babel/preset-env']
};
```


### æ·»åŠ  Node Script


ä¸ºäº†å®ç°ä¸€é”®æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥ç¼–å†™ä¸€ä¸ª Node Scriptã€‚æ‰“å¼€ `package.json`ï¼Œåœ¨ `scripts` é‡Œæ·»åŠ ï¼š


```json
"lint:prettier": "prettier --loglevel warn --write \"src/**/*.{wxml,wxss,wxs,json,md}\"",
"lint:eslint": "eslint --fix \"src/**/*.js\"",
"lint": "npm run lint:prettier && npm run lint:eslint",
```


> ğŸ’¡ `lint:prettier` ä¸­çš„ `--loglevel warn` å¯ä»¥ä¿è¯ç»ˆç«¯ä¸­ä¸æ˜¾ç¤ºæ ¼å¼åŒ–è¿‡ç¨‹ã€‚å¦‚æœä¸æƒ³åœ¨ç»ˆç«¯ä¸­çœ‹åˆ°ä¸€å¤§å¨çš„æ–‡ä»¶åˆ—è¡¨ï¼Œå°±å¯ä»¥æ·»åŠ è¿™ä¸ªé…ç½®ã€‚æ›´å¤šå‚æ•°å¯ä»¥æŸ¥çœ‹ [å®˜æ–¹æ–‡æ¡£](https://prettier.io/docs/en/cli.html#--loglevel)ã€‚


ç°åœ¨ï¼Œæˆ‘ä»¬åœ¨ç»ˆç«¯ä¸­æ•²å…¥ `npm run lint` å°±å¯ä»¥åŒæ—¶å®ç°æ ¼å¼åŒ–ä»£ç å’Œè¯­æ³•æ£€æŸ¥äº†ã€‚


### å…·ä½“é—®é¢˜å…·ä½“åˆ†æ


å½“æˆ‘ä»¬æ‰§è¡Œ `npm run lint` åï¼Œæ²¡æœ‰æŠ¥é”™å¹¶ä¸ä»£è¡¨æˆ‘ä»¬çš„è¯­æ³•æ˜¯å…¨éƒ¨å®‰å…¨çš„ï¼Œæœ‰æŠ¥é”™ä¹Ÿä¸ä»£è¡¨æˆ‘ä»¬çš„è¯­æ³•æ˜¯ä¸å¯æ‰§è¡Œçš„ã€‚æ¯•ç«ŸçœŸæ­£ç¼–è¯‘ js çš„æ˜¯å¾®ä¿¡å¼€å‘è€…å·¥å…·ï¼Œæ•´ä¸ªç¼–è¯‘è¿‡ç¨‹æ˜¯ä¸€ä¸ªé»‘ç›’ã€‚è€Œæˆ‘ä»¬åªä½¿ç”¨äº† Babel çš„è§£æèƒ½åŠ›ï¼ŒBabel è§£æåç»™å‡ºçš„æŠ¥é”™ä¿¡æ¯åªèƒ½ä½œä¸ºå‚è€ƒã€‚ä½œä¸ºå¼€å‘è€…ï¼Œæˆ‘ä»¬èƒ½æ¶ˆé™¤å°±æ¶ˆé™¤ï¼Œæ¶ˆé™¤ä¸äº†å°±çœ‹çœŸå®ç¯å¢ƒæ˜¯å¦æœ‰é—®é¢˜ï¼Œå¦‚æœæ²¡æœ‰é—®é¢˜å¿½ç•¥å³å¯ã€‚


ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘çš„æŸä¸ªé¡¹ç›®ä¸­æœ‰ç¼–å†™äº†å¾ˆå¤šä½¿ç”¨ Class è¯­æ³•çš„ç±»ï¼Œè€Œ Class ç±»é‡Œé¢çš„é™æ€æˆå‘˜éƒ½ä¼šæŠ¥é”™ï¼š


```javascript
23:22  error  Parsing error: /Users/zy/Developer/Sohu/pickpick-wxmp/src/utils/Auth.js: Support for the experimental syntax 'classProperties' isn't currently enabled (23:23):

  21 |  */
  22 | export class Auth {
> 23 |   static keyIsWxLogin = 'user:is_wx_login';
     |                       ^
  24 |   static keyIsLogged = 'user:is_logged';

Add @babel/plugin-proposal-class-properties (https://git.io/vb4SL) to the 'plugins' section of your Babel config to enable transformation.
If you want to leave it as-is, add @babel/plugin-syntax-class-properties (https://git.io/vb4yQ) to the 'plugins' section to enable parsing
```


ä½†äº‹å®ä¸Šè¿™ç§é™æ€å˜é‡è¯­æ³•æ˜¯èƒ½å¤Ÿåœ¨å°ç¨‹åºä¸­æ­£å¸¸ä½¿ç”¨çš„ï¼Œåªéœ€è¦å¿½ç•¥è¿™äº›å¼‚å¸¸å³å¯ã€‚æˆ–è€…æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡ç»™ Babel æ·»åŠ  `@babel/plugin-proposal-class-properties` æ’ä»¶è§£å†³è¿™äº›æŠ¥é”™ã€‚

